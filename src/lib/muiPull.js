!function(a,o,l){var r="beforeChangeOffset",p="afterChangeOffset",t=a.className("transitioning"),h=a.className("pull-top-tips"),e=a.className("pull-bottom-tips"),i=a.className("pull-loading"),s=a.className("scroll"),n=a.className("pull-loading")+" "+a.className("icon")+" "+a.className("icon-pulldown"),u=n+" "+a.className("reverse"),d=a.className("pull-loading")+" "+a.className("spinner"),c=a.className("hidden"),f="."+i;a.PullToRefresh=a.Class.extend({init:function(t,i){this.element=t,this.options=a.extend(!0,{down:{height:75,callback:!1},up:{auto:!1,offset:100,show:!0,contentinit:"上拉显示更多",contentdown:"上拉显示更多",contentrefresh:"正在加载...",contentnomore:"没有更多数据了",callback:!1},preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/}},i),this.stopped=this.isNeedRefresh=this.isDragging=!1,this.state=r,this.isInScroll=this.element.classList.contains(s),this.initPullUpTips(),this.initEvent()},_preventDefaultException:function(t,i){for(var e in i)if(i[e].test(t[e]))return!0;return!1},initEvent:function(){a.isFunction(this.options.down.callback)&&(this.element.addEventListener(a.EVENT_START,this),this.element.addEventListener("drag",this),this.element.addEventListener("dragend",this)),this.pullUpTips&&(this.element.addEventListener("dragup",this),this.isInScroll?this.element.addEventListener("scrollbottom",this):o.addEventListener("scroll",this))},handleEvent:function(t){switch(t.type){case a.EVENT_START:this.isInScroll&&this._canPullDown()&&t.target&&!this._preventDefaultException(t.target,this.options.preventDefaultException)&&t.preventDefault();break;case"drag":this._drag(t);break;case"dragend":this._dragend(t);break;case"webkitTransitionEnd":this._transitionEnd(t);break;case"dragup":case"scroll":this._dragup(t);break;case"scrollbottom":t.target===this.element&&this.pullUpLoading(t)}},initPullDownTips:function(){var t,i=this;a.isFunction(i.options.down.callback)&&(i.pullDownTips=((t=l.querySelector("."+h))&&t.parentNode.removeChild(t),t||((t=l.createElement("div")).classList.add(h),t.innerHTML='<div class="mui-pull-top-wrapper"><span class="mui-pull-loading mui-icon mui-icon-pulldown"></span></div>',t.addEventListener("webkitTransitionEnd",i)),i.pullDownTipsIcon=t.querySelector(f),l.body.appendChild(t),t))},initPullUpTips:function(){var t,i=this;a.isFunction(i.options.up.callback)&&(i.pullUpTips=((t=i.element.querySelector("."+e))||((t=l.createElement("div")).classList.add(e),i.options.up.show||t.classList.add(c),t.innerHTML='<div class="mui-pull-bottom-wrapper"><span class="mui-pull-loading">'+i.options.up.contentinit+"</span></div>",i.element.appendChild(t)),i.pullUpTipsIcon=t.querySelector(f),t))},_transitionEnd:function(t){t.target===this.pullDownTips&&this.removing&&this.removePullDownTips()},_dragup:function(t){var i=this;if(!i.loading){if(t&&t.detail&&a.gestures.session.drag)i.isDraggingUp=!0;else if(!i.isDraggingUp)return;i.isDragging||i._canPullUp()&&i.pullUpLoading(t)}},_canPullUp:function(){if(this.removing)return!1;if(this.isInScroll){var t=this.element.parentNode.getAttribute("data-scroll");if(t){var i=a.data[t];return i.y===i.maxScrollY}}return o.pageYOffset+o.innerHeight+this.options.up.offset>=l.documentElement.scrollHeight},_canPullDown:function(){if(this.removing)return!1;if(this.isInScroll){var t=this.element.parentNode.getAttribute("data-scroll");if(t)return 0===a.data[t].y}return 0===l.body.scrollTop},_drag:function(t){if(this.loading||this.stopped)return t.stopPropagation(),void t.detail.gesture.preventDefault();var i=t.detail;if(!this.isDragging&&"down"===i.direction&&this._canPullDown()){if(l.querySelector("."+h))return t.stopPropagation(),void t.detail.gesture.preventDefault();this.isDragging=!0,this.removing=!1,this.startDeltaY=i.deltaY,a.gestures.session.lockDirection=!0,a.gestures.session.startDirection=i.direction,this._pullStart(this.startDeltaY)}if(this.isDragging){t.stopPropagation(),t.detail.gesture.preventDefault();var e=i.deltaY-this.startDeltaY;e=Math.min(e,1.5*this.options.down.height),this.deltaY=e,this._pulling(e);var s=e>this.options.down.height?p:r;if(this.state!==s&&(this.state=s,this.state===p?(this.removing=!1,this.isNeedRefresh=!0):(this.removing=!0,this.isNeedRefresh=!1),this["_"+s](e)),a.os.ios&&8<=parseFloat(a.os.version)){var n=i.gesture.touches[0].clientY;if(n+10>o.innerHeight||n<10)return void this._dragend(t)}}},_dragend:function(t){var i=this;i.isDragging&&(i.isDragging=!1,i._dragEndAfterChangeOffset(i.isNeedRefresh)),i.isPullingUp&&(i.pullingUpTimeout&&clearTimeout(i.pullingUpTimeout),i.pullingUpTimeout=setTimeout(function(){i.isPullingUp=!1},1e3))},_pullStart:function(t){this.pullStart(t),a.trigger(this.element,"pullstart",{api:this,startDeltaY:t})},_pulling:function(t){this.pulling(t),a.trigger(this.element,"pulling",{api:this,deltaY:t})},_beforeChangeOffset:function(t){this.beforeChangeOffset(t),a.trigger(this.element,"beforeChangeOffset",{api:this,deltaY:t})},_afterChangeOffset:function(t){this.afterChangeOffset(t),a.trigger(this.element,"afterChangeOffset",{api:this,deltaY:t})},_dragEndAfterChangeOffset:function(t){this.dragEndAfterChangeOffset(t),a.trigger(this.element,"dragEndAfterChangeOffset",{api:this,isNeedRefresh:t})},removePullDownTips:function(){if(this.pullDownTips)try{this.pullDownTips.parentNode&&this.pullDownTips.parentNode.removeChild(this.pullDownTips),this.pullDownTips=null,this.removing=!1}catch(t){}},pullStart:function(t){this.initPullDownTips(t)},pulling:function(t){this.pullDownTips.style.webkitTransform="translate3d(0,"+t+"px,0)"},beforeChangeOffset:function(t){this.pullDownTipsIcon.className=n},afterChangeOffset:function(t){this.pullDownTipsIcon.className=u},dragEndAfterChangeOffset:function(t){t?(this.pullDownTipsIcon.className=d,this.pullDownLoading()):(this.pullDownTipsIcon.className=n,this.endPullDownToRefresh())},pullDownLoading:function(){if(!this.loading){if(!this.pullDownTips)return this.initPullDownTips(),void this.dragEndAfterChangeOffset(!0);this.loading=!0,this.pullDownTips.classList.add(t),this.pullDownTips.style.webkitTransform="translate3d(0,"+this.options.down.height+"px,0)",this.options.down.callback.apply(this)}},pullUpLoading:function(t){this.loading||this.finished||(this.loading=!0,this.isDraggingUp=!1,this.pullUpTips.classList.remove(c),t&&t.detail&&t.detail.gesture&&t.detail.gesture.preventDefault(),this.pullUpTipsIcon.innerHTML=this.options.up.contentrefresh,this.options.up.callback.apply(this))},endPullDownToRefresh:function(){this.loading=!1,this.pullUpTips&&this.pullUpTips.classList.remove(c),this.pullDownTips.classList.add(t),this.pullDownTips.style.webkitTransform="translate3d(0,0,0)",this.deltaY<=0?this.removePullDownTips():this.removing=!0,this.isInScroll&&a(this.element.parentNode).scroll().refresh()},endPullUpToRefresh:function(t){t?(this.finished=!0,this.pullUpTipsIcon.innerHTML=this.options.up.contentnomore,this.element.removeEventListener("dragup",this),o.removeEventListener("scroll",this)):this.pullUpTipsIcon.innerHTML=this.options.up.contentdown,this.loading=!1,this.isInScroll&&a(this.element.parentNode).scroll().refresh()},setStopped:function(t){t!=this.stopped&&(this.stopped=t,this.pullUpTips&&this.pullUpTips.classList[t?"add":"remove"](c))},refresh:function(t){t&&this.finished&&this.pullUpTipsIcon&&(this.pullUpTipsIcon.innerHTML=this.options.up.contentdown,this.element.addEventListener("dragup",this),o.addEventListener("scroll",this),this.finished=!1)}}),a.fn.pullToRefresh=function(e){var s=[];return e=e||{},this.each(function(){var t=null,i=this.getAttribute("data-pullToRefresh");i?t=a.data[i]:(i=++a.uuid,a.data[i]=t=new a.PullToRefresh(this,e),this.setAttribute("data-pullToRefresh",i)),e.up&&e.up.auto&&t.pullUpLoading(),s.push(t)}),1===s.length?s[0]:s}}(mui,window,document),function(e){var s=e.className("pull-top-tips");e.PullToRefresh=e.PullToRefresh.extend({init:function(t,i){this._super(t,i),this.options=e.extend(!0,{down:{tips:{colors:["008000","d8ad44","d00324","dc00b8","017efc"],size:200,lineWidth:15,duration:1e3,tail_duration:2500}}},this.options),this.options.down.tips.color=this.options.down.tips.colors[0],this.options.down.tips.colors=this.options.down.tips.colors.map(function(t){return{r:parseInt(t.substring(0,2),16),g:parseInt(t.substring(2,4),16),b:parseInt(t.substring(4,6),16)}})},initPullDownTips:function(){var t,i=this;e.isFunction(i.options.down.callback)&&(i.pullDownTips=((t=document.querySelector("."+s))&&t.parentNode.removeChild(t),t||((t=document.createElement("div")).classList.add(s),t.innerHTML='<div class="mui-pull-top-wrapper"><div class="mui-pull-top-canvas"><canvas id="pullDownTips" width="'+i.options.down.tips.size+'" height="'+i.options.down.tips.size+'"></canvas></div></div>',t.addEventListener("webkitTransitionEnd",i),document.body.appendChild(t)),i.pullDownCanvas=document.getElementById("pullDownTips"),i.pullDownCanvasCtx=i.pullDownCanvas.getContext("2d"),i.canvasUtils.init(i.pullDownCanvas,i.options.down.tips),t))},removePullDownTips:function(){this._super(),this.canvasUtils.stopSpin()},pulling:function(t){var i=Math.min(t/(1.5*this.options.down.height),1),e=Math.min(1,2*i);this.pullDownTips.style.webkitTransform="translate3d(0,"+(t<0?0:t)+"px,0)",this.pullDownCanvas.style.opacity=e,this.pullDownCanvas.style.webkitTransform="rotate("+300*i+"deg)";var s=this.pullDownCanvas,n=this.pullDownCanvasCtx,a=this.options.down.tips.size;n.lineWidth=this.options.down.tips.lineWidth,n.fillStyle="#"+this.options.down.tips.color,n.strokeStyle="#"+this.options.down.tips.color,n.stroke(),n.clearRect(0,0,a,a),s.style.display="none",s.offsetHeight,s.style.display="inherit",this.canvasUtils.drawArcedArrow(n,a/2+.5,a/2,a/4,0*Math.PI,5/3*Math.PI*e,!1,1,2,.7853981633974483,25,this.options.down.tips.lineWidth,this.options.down.tips.lineWidth)},beforeChangeOffset:function(t){},afterChangeOffset:function(t){},dragEndAfterChangeOffset:function(t){t?(this.canvasUtils.startSpin(),this.pullDownLoading()):(this.canvasUtils.stopSpin(),this.endPullDownToRefresh())},canvasUtils:function(){var a=null,o=null,l=200,r=15,p=0,h=0,u=0,d=0,c=0,f=180,g=Math.PI/180,v=1e3,m=2500,T=["35ad0e","d8ad44","d00324","dc00b8","017efc"],w=null;function D(t,i,e,s){return e*t/s+i}function b(t,i,e){var s=Math.min(i,e),n=Math.max(i,e);return t<s?s:n<t?s:t}var M=function(t,i,e,s,n,a,o,l){"use strict";"string"==typeof i&&(i=parseInt(i)),"string"==typeof e&&(e=parseInt(e)),"string"==typeof s&&(s=parseInt(s)),"string"==typeof n&&(n=parseInt(n)),"string"==typeof a&&(a=parseInt(a)),"string"==typeof o&&(o=parseInt(o));Math.PI;switch(t.save(),t.beginPath(),t.moveTo(i,e),t.lineTo(s,n),t.lineTo(a,o),l){case 0:var r=Math.sqrt((a-i)*(a-i)+(o-e)*(o-e));t.arcTo(s,n,i,e,.55*r),t.fill();break;case 1:t.beginPath(),t.moveTo(i,e),t.lineTo(s,n),t.lineTo(a,o),t.lineTo(i,e),t.fill();break;case 2:t.stroke();break;case 3:var p=(i+s+a)/3,h=(e+n+o)/3;t.quadraticCurveTo(p,h,i,e),t.fill();break;case 4:var u,d,c,f;if(a==i)c=u=(s+i)/2,d=n+(r=o-e)/5,f=n-r/5;else{var g=((i+a)/2+s)/2,v=((e+o)/2+n)/2,m=(o-e)/(a-i),T=(r=Math.sqrt((a-i)*(a-i)+(o-e)*(o-e)))/(2*Math.sqrt(m*m+1))/5,w=m*T;u=g-T,d=v-w,c=g+T,f=v+w}t.bezierCurveTo(u,d,c,f,i,e),t.fill()}t.restore()},I=function(t,i,e,s,n,a,o,l,r){"use strict";"string"==typeof i&&(i=parseInt(i)),"string"==typeof e&&(e=parseInt(e)),"string"==typeof s&&(s=parseInt(s)),"string"==typeof n&&(n=parseInt(n)),a=void 0!==a?a:3,o=void 0!==o?o:1,l=void 0!==l?l:Math.PI/8,r=void 0!==r?r:10;var p,h,u,d,c="function"!=typeof a?M:a,f=Math.sqrt((s-i)*(s-i)+(n-e)*(n-e)),g=(f-r/3)/f;1&o?(p=Math.round(i+(s-i)*g),h=Math.round(e+(n-e)*g)):(p=s,h=n),2&o?(u=i+(s-i)*(1-g),d=e+(n-e)*(1-g)):(u=i,d=e),t.beginPath(),t.moveTo(u,d),t.lineTo(p,h),t.stroke();var v=Math.atan2(n-e,s-i),m=Math.abs(r/Math.cos(l));if(1&o){var T=v+Math.PI+l,w=s+Math.cos(T)*m,D=n+Math.sin(T)*m,b=v+Math.PI-l;c(t,w,D,s,n,s+Math.cos(b)*m,n+Math.sin(b)*m,a)}if(2&o){T=v+l,b=v-l;c(t,w=i+Math.cos(T)*m,D=e+Math.sin(T)*m,i,e,i+Math.cos(b)*m,e+Math.sin(b)*m,a)}},y=function(t){var i,e,s,n=t||(new Date).getTime();h||(h=n),i=((p=n-h)+m/2)%m,e=0,s=v,d=(i/=m/2)<1?s/2*i*i+e:-s/2*(--i*(i-2)-1)+e,c=D((p+d)%v,0,360,v),f=20+Math.abs(D((p+m/2)%m,-300,600,m)),o.lineWidth=r,o.lineCap="round",o.strokeStyle=function(t,i){var e=t%i;e<u&&T.push(T.shift());var s=T[0],n=T[1],a=b(D(e,s.r,n.r-s.r,i),s.r,n.r),o=b(D(e,s.g,n.g-s.g,i),s.g,n.g),l=b(D(e,s.b,n.b-s.b,i),s.b,n.b);return u=e,"rgb("+parseInt(a)+","+parseInt(o)+","+parseInt(l)+")"}(p,v),o.clearRect(0,0,l,l),a.style.display="none",a.offsetHeight,a.style.display="inherit",o.beginPath(),o.arc(l/2,l/2,l/4,parseInt(c-f)%360*g,parseInt(c)%360*g,!1),o.stroke(),w=requestAnimationFrame(y)};return{init:function(t,i){o=(a=t).getContext("2d");i=e.extend(!0,{},i);T=i.colors,v=i.duration,m=i.tail_duration,l=i.size,r=i.lineWidth},drawArcedArrow:function(t,i,e,s,n,a,o,l,r,p,h,u,d){"use strict";var c,f,g,v,m;l=void 0!==l?l:3,r=void 0!==r?r:1,p=void 0!==p?p:Math.PI/8,u=u||1,d=d||10,h=void 0!==h?h:10,t.save(),t.lineWidth=u,t.beginPath(),t.arc(i,e,s,n,a,o),t.stroke(),1&r&&(c=Math.cos(n)*s+i,f=Math.sin(n)*s+e,g=Math.atan2(i-c,f-e),o?(v=c+10*Math.cos(g),m=f+10*Math.sin(g)):(v=c-10*Math.cos(g),m=f-10*Math.sin(g)),I(t,c,f,v,m,l,2,p,h)),2&r&&(c=Math.cos(a)*s+i,f=Math.sin(a)*s+e,g=Math.atan2(i-c,f-e),o?(v=c-10*Math.cos(g),m=f-10*Math.sin(g)):(v=c+10*Math.cos(g),m=f+10*Math.sin(g)),I(t,c-d*Math.sin(a),f+d*Math.cos(a),v-d*Math.sin(a),m+d*Math.cos(a),l,2,p,h)),t.restore()},startSpin:function(){u=h=0,w=requestAnimationFrame(y)},stopSpin:function(){w&&cancelAnimationFrame(w)}}}()})}(mui);